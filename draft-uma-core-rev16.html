<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><HTML 
lang="en"><HEAD><TITLE>User-Managed Access (UMA) Core Protocol</TITLE>
<META content="text/html; charset=utf-8" http-equiv="Content-Type">
<META name="description" content="User-Managed Access (UMA) Core Protocol">
<META name="GENERATOR" content="MSHTML 9.00.8112.16434">
<STYLE type="text/css"><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></STYLE>
</HEAD>
<BODY>
<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<TABLE border="0" cellSpacing="0" summary="layout" cellPadding="0" 
  width="66%"><TBODY>
  <TR>
    <TD>
      <TABLE border="0" cellSpacing="1" summary="layout" cellPadding="2" width="100%">
        <TBODY>
        <TR>
          <TD class="header">Network Working Group</TD>
          <TD class="header">T. Hardjono, Ed.</TD></TR>
        <TR>
          <TD class="header">Internet-Draft</TD>
          <TD class="header">MIT</TD></TR>
        <TR>
          <TD class="header">Intended status: Standards Track</TD>
          <TD class="header">C. Scholz</TD></TR>
        <TR>
          <TD class="header">Expires: January 3, 2012</TD>
          <TD class="header">COM.lounge GmbH</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">P. Bryan</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">pbryan.net</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">M. Machulak</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">Newcastle University</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">E. Maler</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">XMLgrrl.com</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">L. Moren</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">Newcastle University</TD></TR>
        <TR>
          <TD class="header">&nbsp;</TD>
          <TD class="header">July 2, 2011</TD></TR>
</TBODY></TABLE></TD></TR></TBODY></TABLE>
<H1><BR>User-Managed Access (UMA) Core 
Protocol<BR>draft-hardjono-oauth-umacore-00-rev16</H1>
<H3>Abstract</H3>
<P>This specification defines the User-Managed Access (UMA) core protocol. This 
protocol provides a method for users to control access to their protected 
resources, residing on any number of host sites, through an authorization 
manager that governs access decisions based on user policy.</P>
<P>This document is an approved Report of the User-Managed Access Work Group of 
the Kantara Initiative. The User-Managed Access Work Group operates under 
Kantara IPR Policy - Option Patent and Copyright: Reciprocal Royalty Free with 
Opt-Out to Reasonable And Non discriminatory (RAND) and the publication of this 
document is governed by the policies outlined in this option.</P>
<H3>Status of this Memo</H3>
<P>This Internet-Draft is submitted  in full conformance with the provisions of 
BCP&nbsp;78 and BCP&nbsp;79.</P>
<P>Internet-Drafts are working documents of the Internet Engineering Task Force 
(IETF).  Note that other groups may also distribute working documents as 
Internet-Drafts.  The list of current Internet-Drafts is at 
http://datatracker.ietf.org/drafts/current/.</P>
<P>Internet-Drafts are draft documents valid for a maximum of six months and may 
be updated, replaced, or obsoleted by other documents at any time. It is 
inappropriate to use Internet-Drafts as reference material or to cite them other 
than as “work in progress.”</P>
<P>This Internet-Draft will expire on January 3, 2012.</P>
<H3>Copyright Notice</H3>
<P>Copyright (c) 2011 IETF Trust and the persons identified as the document 
authors.  All rights reserved.</P>
<P>This document is subject to BCP 78 and the IETF Trust's Legal Provisions 
Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on 
the date of publication of this document.  Please review these documents
 carefully, as they describe your rights and restrictions with respect to this 
document. Code Components extracted from this document must include Simplified 
BSD License text as described in Section 4.e of the Trust Legal Provisions and 
are provided without warranty as described in the Simplified BSD License.</P><A 
name="toc"></A><BR>
<HR>

<H3>Table of Contents</H3>
<P class="toc"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor1">1.</A>&nbsp;
 Introduction<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor2">1.1.</A>&nbsp;
 Notational Conventions<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor3">1.2.</A>&nbsp;
 Terminology<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor4">1.3.</A>&nbsp;
 Endpoint Names<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#protecting-a-resource">2.</A>&nbsp;
 Protecting a Resource<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor5">2.1.</A>&nbsp;
 Host Looks Up AM Metadata<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">2.1.1.</A>&nbsp;
 AM Endpoints<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor6">2.1.2.</A>&nbsp;
 Example AM Metadata<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor7">2.2.</A>&nbsp;
 Host Registers with AM<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor8">2.3.</A>&nbsp;
 Host Obtains Host Access Token<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor9">2.4.</A>&nbsp;
 Host Registers Sets of Resources to Be Protected<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#resource-reg-example">2.4.1.</A>&nbsp;
 Example of Registering Resource Sets<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#action-desc">2.4.2.</A>&nbsp;
 Scope Descriptions<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#resource-set-desc">2.4.3.</A>&nbsp;
 Resource Set Descriptions<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#reg-api">2.4.4.</A>&nbsp;
 Resource Set Registration API<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#getting-authz-accessing-resource">3.</A>&nbsp;
 Getting Authorization and Accessing a Resource<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-h-attempt-access">3.1.</A>&nbsp;
 Requester-Host: Attempt Access at Protected Resource<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#ambiguous-user">3.1.1.</A>&nbsp;
 Requester's Request Is Ambiguous<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#no-token">3.1.2.</A>&nbsp;
 Requester Presents No Access Token<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor10">3.1.3.</A>&nbsp;
 Requester Presents an Invalid Access Token<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#insufficient-scope">3.1.4.</A>&nbsp;
 Requester's Token Has Insufficient Permission<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#sufficient-scope">3.1.5.</A>&nbsp;
 Requester's Token Has Sufficient Permission<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-obtain-token">3.2.</A>&nbsp;
 Requester-AM: Requester Obtains Access Token<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-token-validation">3.3.</A>&nbsp;
 Host-AM: Ask for Requester's Presented Access Token Status<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#token-valid">3.3.1.</A>&nbsp;
 AM Returns a Token Status Description<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#token-invalid">3.3.2.</A>&nbsp;
 AM Returns a Token Invalid Response<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-register-scope">3.4.</A>&nbsp;
 Host-AM: Register a Permission<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-register-scope-success-response">3.4.1.</A>&nbsp;
 AM Returns a Permission Registration Success Response<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-register-scope-invalid-response">3.4.2.</A>&nbsp;
 AM Returns a Permission Registration Error Response<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-authz-scope">3.5.</A>&nbsp;
 Requester-AM: Request Authorization to Add Permission<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#trusted-claims">3.5.1.</A>&nbsp;
 Trusted Claims with OpenID Connect<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-add-permissions-success-response">3.5.2.</A>&nbsp;
 AM Returns an Add Permission Success Response<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-add-permissions-invalid-response">3.5.3.</A>&nbsp;
 AM Returns an Add Permission Error Response<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor11">4.</A>&nbsp;
 Error Messages<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#oauth-error-response">4.1.</A>&nbsp;
 OAuth Error Responses<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#uma-error-response">4.2.</A>&nbsp;
 UMA Error Responses<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor12">5.</A>&nbsp;
 Security Considerations<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor13">6.</A>&nbsp;
 Privacy Considerations<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor14">7.</A>&nbsp;
 Conformance<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#IANA">8.</A>&nbsp;
 IANA Considerations<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#Acknowledgments">9.</A>&nbsp;
 Acknowledgments<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#anchor15">10.</A>&nbsp;
 Issues<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#rfc.references1">11.</A>&nbsp;
 References<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#rfc.references1">11.1.</A>&nbsp;
 Normative References<BR>&nbsp;&nbsp;&nbsp;&nbsp;<A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#rfc.references2">11.2.</A>&nbsp;
 Informative References<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#History">Appendix&nbsp;A.</A>&nbsp;
 Document History<BR><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#rfc.authors">§</A>&nbsp;
 Authors' Addresses<BR></P><BR clear="all"><A name="anchor1"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1"></A>
<H3>1.&nbsp; Introduction</H3>
<P>The User-Managed Access (UMA) core protocol provides a method based on <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
2010.</SPAN><SPAN>)</SPAN></A> (currently draft 16) for users to control access 
to their protected resources, residing on any number of host sites, through a 
single authorization manager (AM) that governs access decisions based on user 
policy.</P>
<P>There are numerous use cases for UMA, where a resource owner nominates a 
third party to control access to these resources potentially without the 
real-time presence of the resource owner. A typical example is the following. A 
web user (authorizing user) can authorize a web app (requester) to gain one-time 
or ongoing access to a resource containing his home address stored at a 
"personal data store" service (host), by telling the host to act on access 
decisions made by his authorization decision-making service (authorization 
manager or AM). The requesting party might be an e-commerce company whose site 
is acting on behalf of the user himself to assist him/her in arranging for 
shipping a purchased item, or it might be his friend who is using an online 
address book service to collect addresses, or it might be a survey company that 
uses an online service to compile population demographics. Other scenarios and 
use cases for UMA usage can be found in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#UMA-usecases">[UMA‑usecases]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Scenarios and Use Cases,” 
October&nbsp;2010.</SPAN><SPAN>)</SPAN></A> and <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#UMA-userstories">[UMA‑userstories]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA User Stories,” 
November&nbsp;2010.</SPAN><SPAN>)</SPAN></A>.</P>
<P>In enterprise settings, application access management often involves letting 
back-office applications serve only as policy enforcement points (PEPs), 
depending entirely on access decisions coming from a central policy decision 
point (PDP) to govern the access they give to requesters. This separation eases 
auditing and allows policy administration to scale in several dimensions. UMA 
makes use of a separation similar to this, letting the authorizing user serve as 
a policy administrator crafting authorization strategies on his or her own 
behalf.</P>
<P>The UMA protocol profiles and extends <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
2010.</SPAN><SPAN>)</SPAN></A>. An AM serves as an enhanced OAuth authorization 
server; a host serves as an enhanced resource server; and a requester serves as 
an enhanced client, acquiring an access token and the requisite authorization to 
access a protected resource at the host.</P>
<P>UMA defines an interoperable protection API between the AM and host, allowing 
them to reside in separate domains and allowing the host to establish mutual 
trust with an AM on behalf of a particular user. This API is itself 
OAuth-protected. Thus, the overall UMA flow has a second embedded OAuth-based 
interaction within it governing the host-AM relationship.</P>
<P>The UMA protocol has three broad phases (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#UMA-phases">Figure&nbsp;1</A>).
</P><BR>
<HR class="insert">
<A name="UMA-phases"></A>
<P style="text-align: center;">The Three Phases of the UMA Protocol</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>                                   +-----+----------------+
                                   | UA  |  authorizing   |
               +-------Manage (A)--|     |      user      |
               |                   +-----+----------------+
               |   Phase 1:              |       UA       |
               |   protect a             +----------------+
               |   resource                      |
               |                            Control (B)
               |                                 |
               v                                 v
        +-----------+              +-----+----------------+
        |   host    |&lt;-Protect-(C)-|prot | authorization  |
        |           |              | API |  manager (AM)  |
        +-----------+              +-----+----------------+
        | protected |                    | authorization  |
        | resource  |                    |      API       |
        +-----------+                    +----------------+
               ^                                 |
               |   Phases 2 and 3:         Authorize (D)
               |   get authz and                 |
               |   access a resource             v
               |                         +----------------+
               +-------Access (E)--------|   requester    |
                                         +----------------+
                                         (requesting party)</PRE></DIV>
<TABLE border="0" cellSpacing="2" cellPadding="0" align="center">
  <TBODY>
  <TR>
    <TD align="center"><FONT size="1" 
      face="monaco, MS Sans Serif"><B>&nbsp;Figure&nbsp;1&nbsp;</B></FONT><BR></TD></TR></TBODY></TABLE>
<HR class="insert">

<P>The phases work as follows: </P>
<OL class="text">
  <LI>Protect a resource: This phase involves the authorizing user, host, and 
  AM. The authorizing user has chosen to use a host for managing online 
  resources ("A"), and introduces this host to an AM using an OAuth-mediated 
  interaction that results in the AM giving the host an access token. The host 
  uses AM's protection API to tell the AM what sets of resources to protect 
  ("C"). Out of band of the UMA protocol, the authorizing user instructs the AM 
  what policies to attach to the registered resource sets ("B"). This phase is 
  described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#protecting-a-resource">Section&nbsp;2<SPAN> 
  (</SPAN><SPAN class="info">Protecting a Resource</SPAN><SPAN>)</SPAN></A>.
  </LI>
  <LI>Get authorization: This phase involves the requester, host, and AM. It may 
  also involve synchronous involvement by the authorizing user if this person is 
  synonymous with the requesting party. This phase is dominated by a loop of 
  activity in which the requester approaches the host seeking access to a 
  protected resource ("E"), is sent to obtain an access token from the AM if it 
  does not have one, and then must demonstrate to the AM that it satisfies the 
  user's authorization policy governing the sought-for resource and scope of 
  access if the host discovers that it does not have the requisite authorization 
  ("D"). This phase is described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#getting-authz-accessing-resource">Section&nbsp;3<SPAN> 
  (</SPAN><SPAN class="info">Getting Authorization and Accessing a 
  Resource</SPAN><SPAN>)</SPAN></A>.</LI>
  <LI>Access a resource: This phase involves the requester successfully 
  presenting an access token that has sufficient permission associated with it 
  to the host in order to gain access to the desired resource ("E"). This phase 
  is described along with Phase 2 in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#getting-authz-accessing-resource">Section&nbsp;3<SPAN> 
  (</SPAN><SPAN class="info">Getting Authorization and Accessing a 
  Resource</SPAN><SPAN>)</SPAN></A>.</LI></OL><A name="anchor2"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.1"></A>
<H3>1.1.&nbsp; Notational Conventions</H3>
<P>The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT', 'SHOULD', 
'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this document are to be 
interpreted as described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#RFC2119">[RFC2119]<SPAN> 
(</SPAN><SPAN class="info">Bradner, S., “Key words for use in RFCs to Indicate 
Requirement Levels,” March&nbsp;1997.</SPAN><SPAN>)</SPAN></A>.</P>
<P>Unless otherwise noted, all the protocol parameter names and values are case 
sensitive.</P><A name="anchor3"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.2"></A>
<H3>1.2.&nbsp; Terminology</H3>
<P></P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>authorizing user</DT>
    <DD>An UMA-defined variant of an OAuth resource owner; a web user who 
    configures an authorization manager with policies that control how it 
    governs access decisions when a requester attempts to access a protected 
    resource at a host.</DD>
    <DT>authorization manager (AM)</DT>
    <DD>An UMA-defined variant of an OAuth authorization server that carries out 
    an authorizing user's policies governing access to a protected resource.
    </DD>
    <DT>protected resource</DT>
    <DD>An access-restricted resource at a host, which is being policy-protected 
    by the AM.</DD>
    <DT>host</DT>
    <DD>An UMA-defined variant of an OAuth resource server that enforces access 
    to the protected resources it hosts, as governed by an authorization 
    manager.</DD>
    <DT>host access token</DT>
    <DD>An access token representing the authorizing user's consent for a host 
    to trust a particular authorization manager for control over authorizations 
    to access protected resources hosted there.</DD>
    <DT>claim</DT>
    <DD>A statement of the value or values of one or more identity attributes of 
    a requesting party. Claims are conveyed by a requester on behalf of a 
    requesting party to an authorization manager in an attempt to satisfy an 
    authorizing user's policy.</DD>
    <DT>requester</DT>
    <DD>An UMA-defined variant of an OAuth client that seeks access to a 
    protected resource.</DD>
    <DT>requester access token</DT>
    <DD>An access token that can be associated with permissions to access 
    particular resources at a host on behalf of a particular requesting party.
    </DD>
    <DT>requesting party</DT>
    <DD>A web user, or a corporation or other legal person, that uses a 
    requester to seek access to a protected resource. If the requesting party is 
    a natural person, it may or may not be the same person as the authorizing 
    user.</DD>
    <DT>resource set description</DT>
    <DD>A JSON-formatted document that represents a set of one or more resources 
    to be AM-protected and maps available scopes to them. The host registers a 
    resource set by giving this document to the AM.</DD>
    <DT>scope description</DT>
    <DD>A JSON-formatted document that represents a scope of access on a 
    particular resource set. The host refers to this type of document from 
    within resource set descriptions and permissions that it registers.</DD>
    <DT>token status description</DT>
    <DD>A JSON-formatted document that represents the currently valid 
    permissions for authorized access associated with a requester access token.
    </DD>
    <DT>permission</DT>
    <DD>A scope of access over a particular resource set at a particular host 
    that is being asked for by a requester or that has been granted by an AM.
    </DD></DL></BLOCKQUOTE><A name="anchor4"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.1.3"></A>
<H3>1.3.&nbsp; Endpoint Names</H3>
<P></P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>host access token endpoint</DT>
    <DD>Part of the protection API at the AM used by the host (and part of 
    standard OAuth). The endpoint at the AM at which the host asks for a host 
    access token on the authorizing user's behalf.</DD>
    <DT>host user authorization endpoint</DT>
    <DD>Part of the protection API at the AM used by the host (and part of 
    standard OAuth). The endpoint at the AM to which the host redirects the 
    authorizing user to authorize the host to use this AM for protecting 
    resources, if the authorization code grant type is being used.</DD>
    <DT>resource set registration endpoint</DT>
    <DD>Part of the protection API at the AM used by the host. The endpoint at 
    the AM at which the host registers resource sets which it wants the AM to 
    protect.</DD>
    <DT>permission registration endpoint</DT>
    <DD>Part of the protection API at the AM used by the host. The endpoint at 
    the AM at which the host registers permissions that a requester will be 
    asking for.</DD>
    <DT>token status endpoint</DT>
    <DD>Part of the protection API at the AM used by the host. The endpoint at 
    the AM at which the host submits requester access tokens to learn what 
    currently valid permissions are associated with them.</DD>
    <DT>protected resource endpoint</DT>
    <DD>An endpoint at the host at which a requester attempts to access 
    resources. This can be a singular API endpoint, one of a set of API 
    endpoints, a URI corresponding to an HTML document, or any other 
    Web-accessible URI.</DD>
    <DT>requester access token endpoint</DT>
    <DD>Part of the authorization API at the AM used by the requester (and part 
    of standard OAuth). The endpoint at the AM at which the requester asks for a 
    requester access token.</DD>
    <DT>permission endpoint</DT>
    <DD>Part of the authorization API at the AM used by the requester. The 
    endpoint at the AM at which the requester asks for authorization to have a 
    new permission associated with its requester access token.</DD>
</DL></BLOCKQUOTE><A name="protecting-a-resource"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2"></A>
<H3>2.&nbsp; Protecting a Resource</H3>
<P>Phase 1 of UMA is protecting a resource. For a host to be able to delegate 
authorization of protected-resource access to an AM, the authorizing user must 
first introduce the host to the AM. This phase is concluded successfuly when: 
</P>
<UL class="text">
  <LI>The host has received metadata about the AM, such as endpoints it needs to 
  use in interacting with the AM.</LI>
  <LI>The host has received an OAuth host access token that represents the 
  authorizing user's approval for the host to work with the AM in protecting 
  resources. This host access token is later used when the host makes other 
  requests at the AM's protection API.</LI>
  <LI>The AM has acquired information about resource sets on the host it is 
  supposed to protect on behalf of the authorizing user.</LI></UL>
<P>The user, host, and AM perform the following steps in order to successfully 
complete Phase 1: </P>
<OL class="text">
  <LI>The host looks up the AM's metadata and learns about its protection API 
  endpoints and supported formats.</LI>
  <LI>If the host has not yet obtained a unique OAuth client identifier and 
  optional secret from the AM, it registers with the AM as required. It MAY do 
  this using the OAuth dynamic registration protocol (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#Dyn-Reg">[Dyn‑Reg]<SPAN> 
  (</SPAN><SPAN class="info">Scholz, C., “OAuth Dynamic Client Registration 
  Protocol,” 2010.</SPAN><SPAN>)</SPAN></A>) proposed by UMA WG participants, if 
  the AM supports it.</LI>
  <LI>The host obtains a host access token from the AM with the authorizing 
  user's consent, using either the authorization code grant type or the SAML 
  bearer assertion grant type.</LI>
  <LI>The host registers any resource sets with the AM that are intended to be 
  protected.</LI></OL><A name="anchor5"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.1"></A>
<H3>2.1.&nbsp; Host Looks Up AM Metadata</H3>
<P>The host needs to learn the OAuth- and UMA-related endpoints of the AM before 
they can begin interacting. The authorizing user might provide the AM's location 
to get the host started in this process, for example by typing a URL into a web 
form field or clicking a button. Alternatively, the host might already be 
configured to work with a single AM without requiring any user input. The exact 
process is beyond the scope of this specification, and it is up to the host to 
choose a method to learn the AM's location.</P>
<P>From the data provided, discovered, or configured, the host MUST retrieve the 
hostmeta document as described in Section 2 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta]. For example, if the user 
supplied "am.example.com" as the Authorization Manager's domain, the host 
creates the URL "https://am.example.com/.well-known/host-meta" and performs a 
GET request on it.</P><A name="am-endpoints"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.1.1"></A>
<H3>2.1.1.&nbsp; AM Endpoints</H3>
<P>The AM MUST provide an XRD 1.0-formatted document at the hostmeta location, 
documenting the following: </P>
<UL class="text">
  <LI>A set of protection API endpoints for the host to use</LI>
  <LI>A set of authorization API endpoints for the requester to use</LI>
  <LI>At least one access token format the AM produces</LI>
  <LI>Any claim formats the AM supports</LI></UL>
<P>Property type values for access token and claim format information:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>http://kantarainitiative.org/ns/uma/1.0/token_formats</DT>
    <DD>REQUIRED (one or more). Access token format produced by this AM. 
    Currently the only option is "artifact".</DD>
    <DT>http://kantarainitiative.org/ns/uma/1.0/claim_formats</DT>
    <DD>OPTIONAL (zero or more). Claim format supported by this AM. Currently 
    the options are "openid-connect" and "claims2". If the AM is capable of 
    requesting and accepting any claim formats at all, it MUST declare them.
    </DD></DL></BLOCKQUOTE>
<P>Link relationship rel values for the protection API endpoints for the host to 
use: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>http://kantarainitiative.org/ns/uma/1.0/host_token_uri</DT>
    <DD>REQUIRED. The host access token endpoint. Available HTTP methods are as 
    defined by <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
    (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
    2010.</SPAN><SPAN>)</SPAN></A> for a token endpoint. Supplies the endpoint 
    the host uses to ask for a host access token.</DD>
    <DT>http://kantarainitiative.org/ns/uma/1.0/host_user_uri</DT>
    <DD>REQUIRED. The host user authorization endpoint. Available HTTP methods 
    are as defined by OAuth for an authorization endpoint. Supplies the endpoint 
    the host uses to gather the consent of the authorizing user for a host-AM 
    relationship if it is using the authorization code grant type. The AM MUST 
    support the authorization code grant type method of obtaining the 
    authorizing user's consent.</DD>
    <DT>http://kantarainitiative.org/ns/uma/1.0/host_resource_reg_uri</DT>
    <DD>REQUIRED. The resource set registration endpoint. Requests to this 
    endpoint require a host access token to be present. Supplies the endpoint 
    the host uses for registering resource sets with the AM to be protected (see 
    <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#reg-api">Section&nbsp;2.4.4<SPAN> 
    (</SPAN><SPAN class="info">Resource Set Registration 
    API</SPAN><SPAN>)</SPAN></A>). This endpoint SHOULD require the use of a 
    transport-layer security mechanism such as TLS.</DD>
    <DT>http://kantarainitiative.org/ns/uma/1.0/host_token_status_uri</DT>
    <DD>REQUIRED. The token status endpoint. Requests to this endpoint require a 
    host access token to be present. Supplies the endpoint the host uses to 
    request the status of access tokens presented to them by requesters with 
    respect to currently valid permissions. This endpoint SHOULD require the use 
    of a transport-layer security mechanism such as TLS.</DD>
    <DT>http://kantarainitiative.org/ns/uma/1.0/host_perm_reg_uri</DT>
    <DD>REQUIRED. The permission registration endpoint. Requests to this 
    endpoint require a host access token to be present. Supplies the endpoint 
    the host uses for registering permissions with the AM for which a requester 
    will be seeking authorization (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-register-scope">Section&nbsp;3.4<SPAN> 
    (</SPAN><SPAN class="info">Host-AM: Register a 
    Permission</SPAN><SPAN>)</SPAN></A>). This endpoint SHOULD require the use 
    of a transport-layer security mechanism such as TLS.</DD></DL></BLOCKQUOTE>
<P>Link relationship rel values for the authorization API endpoints for the 
requester to use: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>http://kantarainitiative.org/ns/uma/1.0/req_token_uri</DT>
    <DD>REQUIRED. The requester access token endpoint. Available HTTP methods 
    are as defined by <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
    (</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
    2010.</SPAN><SPAN>)</SPAN></A> for a token issuance endpoint. Supplies the 
    endpoint the requester uses to ask for an access token. This endpoint SHOULD 
    require the use of a transport-layer security mechanism such as TLS.</DD>
    <DT>http://kantarainitiative.org/ns/uma/1.0/req_perm_uri</DT>
    <DD>REQUIRED. The permission endpoint. Supplies the endpoint the requester 
    uses to ask for authorization to have a new permission associated with its 
    existing requester access token, which MUST accompany the request. This 
    endpoint SHOULD require the use of a transport-layer security mechanism such 
    as TLS.</DD></DL></BLOCKQUOTE><A name="anchor6"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.1.2"></A>
<H3>2.1.2.&nbsp; Example AM Metadata</H3>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>&lt;!-- Applies to both hosts and requesters --&gt;

&lt;Property
  type="http://kantarainitiative.org/ns/uma/1.0/token_formats"&gt;artifact
&lt;/Property&gt;
&lt;Property
  type="http://kantarainitiative.org/ns/uma/1.0/claim_formats"&gt;claims2
&lt;/Property&gt;

&lt;!-- Host protection API --&gt;

&lt;!-- AM as authorization server to host-as-client --&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/host_token_uri"
  href="https://am.example.com/host/token_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/host_user_uri"
  href="https://am.example.com/host/user_uri"&gt;
&lt;/Link&gt;

&lt;!-- AM as resource server to host-as-client --&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/host_resource_reg_uri"
  href="https://am.example.com/host/resource_details_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/host_token_status_uri"
  href="https://am.example.com/host/token_validation_uri"&gt;
&lt;/Link&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/host_perm_reg_uri"
  href="https://am.example.com/host/scope_reg_uri"&gt;
&lt;/Link&gt;

&lt;!-- Requester authorization API --&gt;

&lt;!-- AM as authorization server to requester-as-client --&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/req_token_uri"
  href="https://am.example.com/requester/token_uri"&gt;
&lt;/Link&gt;

&lt;!-- AM as resource server to requester-as-client --&gt;
&lt;Link
  rel="http://kantarainitiative.org/ns/uma/1.0/req_perm_uri"
  href="https://am.example.com/requester/perm_uri"&gt;
&lt;/Link&gt;</PRE></DIV>
<A name="anchor7"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.2"></A>
<H3>2.2.&nbsp; Host Registers with AM</H3>
<P>If the host has not already obtained a unique client identifier and optional 
secret from this AM, in this step it MUST do so in order to engage in 
OAuth-based interactions with the AM. It MAY do this using the OAuth dynamic 
registration protocol (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#Dyn-Reg">[Dyn‑Reg]<SPAN> 
(</SPAN><SPAN class="info">Scholz, C., “OAuth Dynamic Client Registration 
Protocol,” 2010.</SPAN><SPAN>)</SPAN></A>) proposed by UMA WG participants, if 
the AM supports it. The AM MUST issue a unique client identifier to every host. 
This is to ensure that individual hosts can be unambiguously identified in 
resource set registration, where the client identifier is used as a URI 
component.</P><A name="anchor8"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.3"></A>
<H3>2.3.&nbsp; Host Obtains Host Access Token</H3>
<P>In this step, the host acquires a host access token from the AM that 
represents the approval of the authorizing user for the host to trust the AM for 
protecting resources belonging to the user.</P>
<P>The host MUST use the <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">OAuth2<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
2010.</SPAN><SPAN>)</SPAN></A> [OAuth2] authorization code grant type or the 
SAML bearer token grant type <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth-SAML">[OAuth‑SAML]<SPAN> 
(</SPAN><SPAN class="info">Campbell, B., “SAML 2.0 Bearer Assertion Grant Type 
Profile for OAuth 2.0,” February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>, utilizing 
the end-user authorization and token endpoints as appropriate. Here the host 
acts in the role of an OAuth client; the authorizing user acts in the role of an 
OAuth end-user resource owner; and the AM acts in the role of an OAuth 
authorization server. (Once the host has obtained an access token, it presents 
it to the AM at various protection API endpoints, at which point the AM acts in 
the role of a resource server.)</P>
<P>The host has completed this step successfully when it possesses a host access 
token it can use at the AM's protection API.</P><A name="anchor9"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4"></A>
<H3>2.4.&nbsp; Host Registers Sets of Resources to Be Protected</H3>
<P>Once the host has received a host access token, for any of the user's sets of 
resources that are to be protected by this AM, it MUST register these resource 
sets at the AM's registration endpoint.</P>
<P>Note that the host is free to offer the option to protect any subset of the 
user's resources using different AMs or other means entirely, or to protect some 
resources and not others. Additionally, the choice of protection regimes can be 
made explicitly by the user or implicitly by the host. Any such partitioning by 
the host or user is outside the scope of this specification.</P><A name="resource-reg-example"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.1"></A>
<H3>2.4.1.&nbsp; Example of Registering Resource Sets</H3>
<P>The following example illustrates the intent and usage of resource set 
registration.</P>
<P>This example contains some steps that are exclusively in the realm of user 
experience rather than web protocol, to achieve realistic illustration; these 
steps are labeled "User experience only". Some other steps are exclusively 
internal to the operation of the entity being discussed; these are labeled 
"Internal only".</P>
<P>An authorizing user, Alice Adams, has just uploaded a photo of her new puppy 
to a host, Photoz.example.com, and wants to ensure that this specific photo is 
not publicly accessible.</P>
<P>Alice has already introduced this host to her AM, CopMonkey.example.com, and 
thus Photoz has already obtained a host access token from CopMonkey. However, 
Alice has not previously instructed Photoz to use CopMonkey to protect any other 
photos of hers.</P>
<P>Alice has previously visited CopMonkey to map a default "do not share with 
anyone" policy to any resource sets registered by Photoz, until such time as she 
maps some other less-draconian policies to those resources. (User experience 
only. This may have been done at the time Alice introduced the host to the AM, 
and/or it could have been a global or host-specific preference setting. A 
different constraint or no constraint at all might be associated with newly 
protected resources.) Other kinds of policies she may eventually map to 
particular photos or albums might be "Share only with husband@email.example.net" 
or "Share only with people in my 'family' group".</P>
<P>Photoz itself has a publicly documented API that offers two dozen different 
methods that apply to single photos, such as "addTags" and "getSizes", but rolls 
them up into two photo-related scopes of access: "viewing" (consisting of 
various read-only operations) and "all" (consisting of various reading, editing, 
and printing operations). It defines two Web-accessible JSON-encoded documents 
called scope descriptions that represent these scopes, which it is able to reuse 
for all of its users (not just Alice).</P>
<P>The "name" parameter values are intended to be seen by Alice when she maps 
authorization constraints to specific resource sets and actions while visiting 
CopMonkey, such that Alice would see the strings "View Photo and Related Info" 
and "All Actions", likely accompanied by the referenced icons, in the CopMonkey 
interface. (Other users of Photoz might similarly see the same labels at 
CopMonkey or whatever other AM they use. Photoz could distinguish 
natural-language labels per user if it wishes, by pointing to scopes with 
differently translated names.)</P>
<P>Example of the "view" scope ,which description is a Web-accessible resource 
at http://photoz.example.com/dev/scopes/view:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
        "scope":
            {
            "_id": "view"
            "name": "View Photo and Related Info",
            "icon_uri": "http://www.example.com/icons/reading-glasses.png"
        }
}</PRE></DIV>
<P>Example of the "all" scope, which description is a Web-accessible resource at 
http://photoz.example.com/dev/scopes/all:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
        "scope":
            {
            "_id": "all"
            "name": "All Actions",
            "icon_uri": "http://www.example.com/icons/galaxy.png"
        }
}</PRE></DIV>
<P>While visiting Photoz, Alice selects a link or button that instructs the site 
to "Protect" or "Share" this single photo (user experience only; Photoz could 
have made this a default or preference setting).</P>
<P>As a result, Photoz defines for itself a resource set that represents this 
photo (internal only; Photoz is the only application that knows how to map a 
particular photo to a particular resource set). Photoz also prepares the 
following resource set description, which is specific to Alice and her photo. 
The "name" parameter value is intended to be seen by Alice in mapping 
authorization constraints to specific resource sets and actions when she visits 
CopMonkey, such that Alice would see the string "Steve the puppy!", likely 
accompanied by the referenced icon, in the CopMonkey interface. The possible 
scopes of access on this resource set are indicated with URI references to the 
scope descriptions, as defined just above.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
        "resource_set":
            {
            "_id": "112210f47de98100"
            "name": "Steve the puppy!",
            "icon_uri": "http://www.example.com/icons/flower",
            "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
        }
}</PRE></DIV>
<P>Photoz uses the "create resource set description" method of CopMonkey's 
standard UMA resource set registration API, presenting its Alice-specific host 
access token there, to register and assign an identifier to the resource set 
description. The resource set identifier path component of the URL matches the 
"_id" parameter value in the description.</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /host/photoz.example.com/resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/json
...

{
        "resource_set":
           {
           "_id": "112210f47de98100"
           "name": "Steve the puppy!",
           "icon_uri": "http://www.example.com/icons/flower.png",
           "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
         }
}</PRE></DIV>
<P>Once this description has been successfully registered, Photoz is responsible 
for responding correctly to requesters' attempts to access this photo, achieving 
protection of the resource by "outsourcing" this task to CopMonkey.</P>
<P>At the time Alice indicates she would like this photo protected, Photoz can 
choose to redirect Alice to CopMonkey for further policy setting, access 
auditing, and other AM-related tasks (user experience only).</P>
<P>Over time, as Alice uploads other photos and creates and organizes photo 
albums, and as Photoz makes new action functionality available, Photoz can use 
additional methods of the resource set registration API to ensure that 
CopMonkey's understanding of Alice's protected resources matches its own.</P><A 
name="action-desc"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.2"></A>
<H3>2.4.2.&nbsp; Scope Descriptions</H3>
<P>The host defines a scope of access that is available for use with resources 
it manages in a publicly Web-accessible document containing a scope description. 
The scopes available for use at any one host MUST have unique URI references so 
that the host's scope descriptions are distinguishable by URI reference; the URI 
reference MAY include a fragment identifier. Scope descriptions MAY reside 
anywhere; the host is not required to self-host scope descriptions and may wish 
to point to standardized scope descriptions residing elsewhere.</P>
<P>A scope description is a <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#RFC4627">JSON<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
[RFC4627] object with the name "scope" and with the following parameters:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>_id</DT>
    <DD>REQUIRED. A string that uniquely identifies the scope across all scopes 
    available at this host.</DD>
    <DT>name</DT>
    <DD>REQUIRED. A human-readable string describing the scope of access. The AM 
    SHOULD use the name in its user interface to assist the user in setting 
    policies for protected resource sets that have this available scope.</DD>
    <DT>icon_uri</DT>
    <DD>OPTIONAL. A URI for a graphic icon representing the scope. If this is 
    provided, the AM SHOULD use the referenced icon in its user interface to 
    assist the user in setting policies for protected resource sets that have 
    this available scope.</DD></DL></BLOCKQUOTE>
<P>For example, this description characterizes a scope that involves reading or 
viewing resources (vs. creating them or editing them in some fashion):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
        "scope":
            {
            "_id": "view"
            "name": "Read-only",
            "icon_uri": "http://www.example.com/icons/reading-glasses"
        }
}</PRE></DIV>
<P>Scope descriptions MAY contain extension parameters that are not defined in 
this specification. The names of extension parameters MUST begin with "x-" or 
"X-".</P><A name="resource-set-desc"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.3"></A>
<H3>2.4.3.&nbsp; Resource Set Descriptions</H3>
<P>The host defines a resource set that needs protection by registering a 
resource set description at the AM. The host registers the description and 
manages its lifecycle at the AM's host resource set registration endpoint by 
using the resource set registration API (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#reg-api">Section&nbsp;2.4.4<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>). The resource set description is a <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#RFC4627">JSON<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
[RFC4627] object with the name "resource_set" and with the following 
parameters:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>_id</DT>
    <DD>REQUIRED. A string that uniquely identifies the resource set. The 
    resource set identifier has meaning only to the host, except insofar as the 
    AM is able to map this resource set description to a particular user by 
    virtue of the particular host access token used to access the resource set 
    registration API. The host MAY use any identifier scheme to represent 
    resource sets, for example, making its identifiers unique across all users 
    of this host or allowing for the sharing of resource set identifiers among 
    users. However, for privacy reasons, it is RECOMMENDED that the host assign 
    an identifier that is obscured with respect to any human-readable resource 
    set label used at this host. Further, this identifier MUST match the 
    resource set identifier path component of the URI used to manage this 
    description in the resource set registration API; see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#reg-api">Section&nbsp;2.4.4<SPAN> 
    (</SPAN><SPAN class="info">Resource Set Registration 
    API</SPAN><SPAN>)</SPAN></A> for more information. (Typically this matching 
    is achieved through automatically populating the parameter value on initial 
    registration of the description.)</DD>
    <DT>name</DT>
    <DD>REQUIRED. A human-readable string describing a set of one or more 
    resources. The AM SHOULD use the name in its user interface to assist the 
    user in setting policing for protecting this resource set.</DD>
    <DT>icon_uri</DT>
    <DD>OPTIONAL. A URI for a graphic icon representing the resource set. If 
    provided, the AM SHOULD use the referenced icon in its user interface to 
    assist the user in setting policies for protecting this resource set.</DD>
    <DT>scopes</DT>
    <DD>REQUIRED. An array referencing one or more URI references of scope 
    descriptions that are available for this resource set.</DD></DL></BLOCKQUOTE>
<P>For example, this description characterizes a resource set (a photo album) 
that can potentially be only viewed, or alternatively to which full access can 
be granted; the URIs point to scopes descriptions as defined in <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#action-desc">Section&nbsp;2.4.2<SPAN> 
(</SPAN><SPAN class="info">Scope Descriptions</SPAN><SPAN>)</SPAN></A>:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>{
        "resource_set":
            {
            "_id":  "112210f47de98100",
            "name": "Photo album",
            "icon_uri": "http://www.example.com/icons/flower.png",
            "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
        }
}</PRE></DIV>
<P>Resource set descriptions MAY contain extension parameters that are not 
defined in this specification. The names of extension parameters MUST begin with 
"x-" or "X-".</P>
<P>When a host creates or updates a resource set description (see <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#reg-api">Section&nbsp;2.4.4<SPAN> 
(</SPAN><SPAN class="info">Resource Set Registration 
API</SPAN><SPAN>)</SPAN></A>), the AM MUST attempt to retrieve the referenced 
scope descriptions. It MAY cache such descriptions as long as indicated in the 
HTTP header for the scope description resource unless the resource set 
description is subsequently updated within the validity period. At the beginning 
of an authorizing user's login session at the AM, the AM MUST attempt to 
re-retrieve scope descriptions applying to that user whose cached versions have 
expired.</P><A name="reg-api"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.4"></A>
<H3>2.4.4.&nbsp; Resource Set Registration API</H3>
<P>The host uses a RESTful API at the AM's resource set registration endpoint to 
create, read, update, and delete resource set descriptions, along with listing 
groups of such descriptions. The host MUST use its valid host access token 
obtained previously to gain access to this endpoint.</P>
<P>(Note carefully the similar but distinct senses in which the word "resource" 
is used in this section. UMA resource set descriptions are themselves managed as 
web resources at the AM through this API.)</P>
<P>Individual resource set descriptions are managed at URIs with this structure: 
"{rsreguri}/host/{hostid}/resource_set/{rsid}"</P>
<P>The components of these URIs are defined as follows:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>{rsreguri}</DT>
    <DD>The AM's resource set registration endpoint as advertised in its 
    metadata (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">Section&nbsp;2.1.1<SPAN> 
    (</SPAN><SPAN class="info">AM Endpoints</SPAN><SPAN>)</SPAN></A>).</DD>
    <DT>{hostid}</DT>
    <DD>A registration area at the AM that is specific to this host. The host 
    MUST use the unique OAuth client identifier it was assigned by this AM as 
    its host identifier. If the host identifier does not match the host access 
    token used at the host registration endpoint, the AM MUST report an HTTP 403 
    Forbidden error and fail to act on the request.</DD>
    <DT>{rsid}</DT>
    <DD>An identifier for a resource set description. The identifier MUST match 
    the "_id" parameter value in the description itself.</DD></DL></BLOCKQUOTE>
<P>Without a specific resource set identifier path component, the URI applies to 
the set of resource set descriptions already registered.</P>
<P>Following is a summary of the five registration operations the AM is REQUIRED 
to support. Each is defined in its own section below. All other methods are 
unsupported.</P>
<UL class="text">
  <LI>Create resource set description: PUT /host/{hostid}/resource_set/{rsid}
  </LI>
  <LI>Read resource set description: GET /host/{hostid}/resource_set/{rsid}</LI>
  <LI>Update resource set description: PUT /host/{hostid}/resource_set/{rsid}
  </LI>
  <LI>Delete resource set description: DELETE /host/{hostid}/resource_set/{rsid}
  </LI>
  <LI>List resource set descriptions: GET /host/{hostid}/resource_set/</LI></UL>
<P>If the request to the resource set registration endpoint is incorrect, then 
the AM responds with an error message (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>) by 
including one of the following error codes with the response: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>unsupported_method_type</DT>
    <DD>The host request used an unsupported HTTP method. The AM MUST respond 
    with the HTTP 403 (Forbidden) status code and MUST fail to act on the 
    request.</DD>
    <DT>hostid_access_token_mismatch</DT>
    <DD>The hostid does not match the presented host access token. The AM MUST 
    respond with the HTTP 403 (Forbidden) status code.</DD>
    <DT>ambiguous_resource_set_id</DT>
    <DD>The resourcesetid provided in the resource set description does not 
    match the one provided in the URI. The AM MUST respond with the HTTP 400 
    (Bad Request) status code and MUST fail to act on the request.</DD>
    <DT>resource_set_not_found</DT>
    <DD>The resource set requested from the AM cannot be found. The AM MUST 
    respond with HTTP 404 (Not Found) status code.</DD>
    <DT>resource_set_mismatch</DT>
    <DD>The resource set that was requested to be deleted or updated at the AM 
    did not match the ETag value present in the request. The AM MUST respond 
    with HTTP 412 (Precondition Failed) status code and MUST fail to act on the 
    request.</DD></DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 403 Forbidden
Content-Type: application/json
Cache-Control: no-store
{
   "error":"unsupported_method_type"
}
</PRE></DIV>
<A name="create-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.4.1"></A>
<H3>2.4.4.1.&nbsp; Create Resource Set Description</H3>
<P>Adds a new resource set description using the PUT method, thereby putting it 
under the AM's protection. The host is free to use its own methods of 
identifying and describing resource sets; the AM MUST treat them as opaque for 
the purpose of authorizing access, other than associating them with the 
authorizing user represented by the host access token used to access the API. On 
successfully registering a resource set, the host MUST use UMA mechanisms to 
limit access to any resources corresponding to this resource set, relying on the 
AM to supply currently valid permissions for authorized access.</P>
<P>HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /host/{hostid}/resource_set/{rsid} HTTP/1.1
Content-Type: application/json
...

(Body contains JSON representation of resource set description to be created)</PRE></DIV>
<P>Example of an HTTP request that creates a resource set description at the AM:
</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /host/photoz.example.com/resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/json
Host: am.example.com

{
        "resource_set":
            {
            "_id":  "112210f47de98100",
            "name": "Photo album",
            "icon_uri": "http://www.example.com/icons/flower.png",
            "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
        }
}</PRE></DIV>
<P>HTTP response (success):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/json
Location: (URL of created resource, same as in the PUT request)
ETag: (entity tag of resource artifact)
...

(Body contains JSON representation of created resource set description)</PRE></DIV>
<P>Example of an HTTP response confirming the created resource set description:
</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/json
Location: https://am.example.com/rsreg_uri/host/photoz.example.com/resource_set/112210f47de98100
ETag: "1234sdbdDX"
...

{
        "resource_set":
            {
            "_id":  "112210f47de98100",
            "name": "Photo album",
            "icon_uri": "http://www.example.com/icons/flower.png",
            "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
        }
}</PRE></DIV>
<A name="read-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.4.2"></A>
<H3>2.4.4.2.&nbsp; Read Resource Set Description</H3>
<P>Reads a previously registered resource set description using the GET method.
</P>
<P>HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /host/{hostid}/resource_set/{rsid} HTTP/1.1
...</PRE></DIV>
<P>Example of an HTTP request that reads a resource set description from the AM:
</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /host/photoz.example.com/resource_set/112210f47de98100 HTTP/1.1
Host: am.example.com
...</PRE></DIV>
<P>HTTP response (success):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
ETag: (entity tag of resource artifact)
...

(Body contains JSON representation of resource set description)</PRE></DIV>
<P>Example of an HTTP response message containing a resource set description 
from the AM:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
ETag: "1234sdbdDX"
...

              {
        "resource_set":
            {
            "_id":  "112210f47de98100",
            "name": "Photo album",
            "icon_uri": "http://www.example.com/icons/flower.png",
            "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
        }</PRE></DIV>
<P>HTTP response (not found):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 404 Not Found
Content-Type: application/json
...

{
   "error":"resource_set_not_found"
}</PRE></DIV>
<A name="update-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.4.3"></A>
<H3>2.4.4.3.&nbsp; Update Resource Set Description</H3>
<P>Updates a previously registered resource set description using the PUT 
method, thereby changing the resource set's protection characteristics.</P>
<P>This operation is different from the operation to create a new resource set 
description (<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#create-resource-set">Section&nbsp;2.4.4.1<SPAN> 
(</SPAN><SPAN class="info">Create Resource Set 
Description</SPAN><SPAN>)</SPAN></A>) because it assumes that prior registration 
of the resource set in question has occurred.</P>
<P>HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /host/{hostid}/resource_set/{rsid} HTTP/1.1
Content-Type: application/json
If-Match: (entity tag of resource if operation is to be idempotent)
...

(Body contains JSON representation of resource set description to be updated)</PRE></DIV>
<P>Example of an HTTP request that updates a resource set description at AM:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>PUT /host/photoz.example.com/resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/json
Host: am.example.com
If-Match: "1234sdbdDX"

{
        "resource_set":
            {
            "_id":  "112210f47de98100",
            "name": "Updated Photo album",
            "icon_uri": "http://www.example.com/icons/sun.png",
            "scopes":
                        ["http://photoz.example.com/dev/scopes/view",
                        "http://photoz.example.com/dev/scopes/all"]
        }
}</PRE></DIV>
<P>HTTP response (success):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 204 No Content
              ETag: "54223dfda"
...</PRE></DIV>
<P>HTTP response (entity tag does not match):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 412 Precondition failed
Content-Type: application/json
...

{
   "error":"resource_set_mismatch"
}</PRE></DIV>
<A name="delete-resource-set"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.4.4"></A>
<H3>2.4.4.4.&nbsp; Delete Resource Set Description</H3>
<P>Deletes a previously registered resource set description using the DELETE 
method, thereby removing it from the AM's protection regime.</P>
<P>HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>DELETE /host/{hostid}/resource_set/{rsid}
If-Match: (entity tag of resource if operation is to be idempotent)
...</PRE></DIV>
<P>Example of an HTTP request that deletes a resource set description from the 
AM:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>DELETE /host/photoz.example.com/resource_set/112210f47de98100 HTTP/1.1
Host: am.example.com
If-Match: "1234sdbdDX"
</PRE></DIV>
<P>HTTP response (success):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 204 No content
...</PRE></DIV>
<P>HTTP response (not found):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 404 Not Found
Content-Type: application/json
...

{
   "error":"resource_set_not_found"
}</PRE></DIV>
<P>HTTP response (entity tag does not match):</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 412 Precondition failed
Content-Type: application/json
...

{
   "error":"resource_set_mismatch"
}</PRE></DIV>
<A name="list-resource-sets"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.2.4.4.5"></A>
<H3>2.4.4.5.&nbsp; List Resource Set Descriptions</H3>
<P>Lists all previously registered resource set identifiers for this user using 
the GET method. The list is in the form of a JSON array of {rsid} values.</P>
<P>HTTP request:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /host/{hostid}/resource_set HTTP/1.1
...</PRE></DIV>
<P>Example of an HTTP request that lists registered resource set descriptions at 
the AM:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>GET /host/photoz.example.com/resource_set HTTP/1.1
Host: am.example.com
...</PRE></DIV>
<P>HTTP response:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
...

(Body contains JSON array of {rsid} values)</PRE></DIV>
<P>Example of an HTTP response with the list of registered resource set 
identifiers:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
...

{
  "resource_set_id_list": [ "112210f47de98100", "34234df47eL95300" ]
}</PRE></DIV>
<A name="getting-authz-accessing-resource"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3"></A>
<H3>3.&nbsp; Getting Authorization and Accessing a Resource</H3>
<P>Phase 2 of UMA is getting authorization, and Phase 3 is accessing a resource. 
In these phases, an AM orchestrates and controls requesting parties' access to a 
user's protected resources at a host, under conditions dictated by that user.
</P>
<P>Phase 3 is merely the successful completion of a requester's access attempt 
(see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#sufficient-scope">Section&nbsp;3.1.5<SPAN> 
(</SPAN><SPAN class="info">Requester's Token Has Sufficient 
Permission</SPAN><SPAN>)</SPAN></A>) that initially involved several embedded 
interactions among the requester, AM, and host in Phase 2. Phase 2 always begins 
with the requester attempting access at a protected resource endpoint at the 
host. How the requester came to learn about this endpoint is out of scope for 
UMA; the authorizing user might, for example, have advertised its availability 
publicly on a blog or other website, listed it in a discovery service, or 
emailed a link to a particular intended requesting party.</P>
<P>The host responds to the requester's access request in one of several ways 
depending on the circumstances of the request, either immediately or having 
first performed one or more embedded interactions with the AM. Depending on the 
nature of the host's response to an failed access attempt, the requester itself 
engages in embedded interactions with the AM before re-attempting access.</P>
<P>The interactions are as follows. The interaction summarized in each top-level 
list item MAY be the last interaction engaged in, if the requester chooses not 
to continue pursuing access to the resource.</P>
<UL class="text">
  <LI>The requester attempts access at a particular protected resource at a host 
  (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-h-attempt-access">Section&nbsp;3.1<SPAN> 
  (</SPAN><SPAN class="info">Requester-Host: Attempt Access at Protected 
  Resource</SPAN><SPAN>)</SPAN></A>).
  <UL class="text">
    <LI>If the user corresponding to the protected resource URI is ambiguous: 
    host responds immediately with an error (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#ambiguous-user">Section&nbsp;3.1.1<SPAN> 
    (</SPAN><SPAN class="info">Requester's Request Is 
    Ambiguous</SPAN><SPAN>)</SPAN></A>).</LI>
    <LI>If the user is unambiguous but the access attempt is unaccompanied by a 
    requester access token: host responds immediately with instructions on where 
    to go to obtain one (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#no-token">Section&nbsp;3.1.2<SPAN> 
    (</SPAN><SPAN class="info">Requester Presents No Access 
    Token</SPAN><SPAN>)</SPAN></A>).</LI></UL></LI>
  <LI>If the access attempt was accompanied by a requester access token, the 
  host checks the token's status at the AM (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
  (</SPAN><SPAN class="info">Host-AM: Ask for Requester's Presented Access Token 
  Status</SPAN><SPAN>)</SPAN></A>).
  <UL class="text">
    <LI>If the AM reports that the requester access token is invalid (see <A 
    class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#token-invalid">Section&nbsp;3.3.2<SPAN> 
    (</SPAN><SPAN class="info">AM Returns a Token Invalid 
    Response</SPAN><SPAN>)</SPAN></A>), the host responds to the requester with 
    instructions on where to go to obtain a token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#no-token">Section&nbsp;3.1.2<SPAN> 
    (</SPAN><SPAN class="info">Requester Presents No Access 
    Token</SPAN><SPAN>)</SPAN></A>).</LI></UL></LI>
  <LI>If the AM supplies a token status description for a valid requester access 
  token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#token-valid">Section&nbsp;3.3.1<SPAN> 
  (</SPAN><SPAN class="info">AM Returns a Token Status 
  Description</SPAN><SPAN>)</SPAN></A>) but none of the permissions associated 
  with the token match the scope of attempted access, the host registers a 
  suitable permission on the requester's behalf at the AM (see <A class="info" 
  href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-register-scope">Section&nbsp;3.4<SPAN> 
  (</SPAN><SPAN class="info">Host-AM: Register a 
  Permission</SPAN><SPAN>)</SPAN></A>) and then responds to the requester with 
  instructions on where to go to request authorization to associate that 
  permission with its token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#insufficient-scope">Section&nbsp;3.1.4<SPAN> 
  (</SPAN><SPAN class="info">Requester's Token Has Insufficient 
  Permission</SPAN><SPAN>)</SPAN></A>).</LI>
  <LI>If the requester received instructions on where to get a token, it 
  requests a token from the appropriate AM (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-obtain-token">Section&nbsp;3.2<SPAN> 
  (</SPAN><SPAN class="info">Requester-AM: Requester Obtains Access 
  Token</SPAN><SPAN>)</SPAN></A>).</LI>
  <LI>If the requester received instructions on where to get authorization for 
  access permission, it requests permission from the appropriate AM (see <A 
  class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-authz-scope">Section&nbsp;3.5<SPAN> 
  (</SPAN><SPAN class="info">Requester-AM: Request Authorization to Add 
  Permission</SPAN><SPAN>)</SPAN></A>).</LI>
  <LI>If the AM gave status back on a valid requester access token, and at least 
  one of the permissions associated with the token match the scope of attempted 
  access, the host responds to the requester's access attempt with success (see 
  <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#sufficient-scope">Section&nbsp;3.1.5<SPAN> 
  (</SPAN><SPAN class="info">Requester's Token Has Sufficient 
  Permission</SPAN><SPAN>)</SPAN></A>).</LI></UL>
<P>This process extends OAuth in several notable ways:</P>
<UL class="text">
  <LI>The requester access token signifies only a binding of this requester, the 
  requesting party on whose behalf it is acting, this host, this authorizing 
  user, and this AM, to be reused for all permissions to access any of the 
  user's protected resources at this host that are protected by this AM.</LI>
  <LI>Any real-time authorizing user (resource owner) consent required by policy 
  is gathered at the time of claim requests, rather than at the time of token 
  issuance; the flow does not distinguish between policies for 
  "person-to-person" sharing and policies for "person-to-self" sharing.</LI>
  <LI>The process of seeking authorization does not just rely on the requester's 
  ability to authenticate as the (or a) resource owner, but admits a 
  wide-ranging set of policy options based on attributes of the requesting 
  party. This model could be called claims-based authorization.</LI>
  <LI>The host is (for now) required to check with the AM in real time about the 
  status of all tokens unseen before or whose cached status has expired. 
  Eventually, this specification will define an interoperable way to use of 
  structured tokens to allow AMs the opportunity to give out requester access 
  tokens whose status hosts can check "locally".</LI></UL>
<P>The interactions are described in detail in the following sections.</P><A 
name="r-h-attempt-access"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1"></A>
<H3>3.1.&nbsp; Requester-Host: Attempt Access at Protected Resource</H3>
<P>This interaction assumes that the host has previously registered with an AM 
one or more resource sets that correspond to the resource to which access is 
being attempted, such that the host considers this resource to be protected by a 
particular AM.</P>
<P>The requester typically attempts to access the desired resource at the host 
directly (for example, when a human operator of the requester software clicks on 
a thumbnail representation of the resource). The requester is expected to 
discover, or be provisioned with, knowledge of the protected resource and its 
location out of band. Further, the requester is expected to acquire its own 
knowledge about the methods made available by the host for operating on this 
resource (such as viewing it with a GET method, or transforming it with some 
complex API call) and the possible scopes of access.</P>
<P>The host responds in one of five ways.</P><A name="ambiguous-user"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.1"></A>
<H3>3.1.1.&nbsp; Requester's Request Is Ambiguous</H3>
<P>By the nature of the requester's request for access (for example, through a 
URI parameter specifying a username or other identifier), the host needs to be 
able to detect uniquely which one of its users has the operative control over 
access to this resource. Without this, the host will be unable to interact with 
the correct AM using the correct host access token in protecting the resource.
</P>
<P>If the requester's request is ambiguous with respect to the specific user at 
the host, the host immediately responds with an "ambiguous-user" error message 
(see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>).</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 403 Forbidden
Content-Type: application/json
Cache-Control: no-store

{
   "error":"ambiguous-user"
}</PRE></DIV>
<A name="no-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.2"></A>
<H3>3.1.2.&nbsp; Requester Presents No Access Token</H3>
<P>If the host is able to detect uniquely which one of its users has the 
operative control over access to the resource (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#ambiguous-user">Section&nbsp;3.1.1<SPAN> 
(</SPAN><SPAN class="info">Requester's Request Is 
Ambiguous</SPAN><SPAN>)</SPAN></A>), but the requester does not present any 
access token with the request, the host MUST return an HTTP 400 (Bad Request) 
status code indicating it is an "invalid_request" (see Section 2.4.1 of <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth-bearer">[OAuth‑bearer]<SPAN> 
(</SPAN><SPAN class="info">Jones, M., “The OAuth 2.0 Protocol: Bearer Tokens,” 
June&nbsp;2011.</SPAN><SPAN>)</SPAN></A>), along with providing the AM's URI. 
This error indicates to the requester that the request is missing a required 
parameter, includes an unsupported parameter or parameter value, repeats the 
same parameter, uses more than one method for including an access token, or is 
otherwise malformed.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
WWW-Authenticate: UMA realm="example"
                     host_id="photoz.example.com",
                     am_uri="http://am.example.com"</PRE></DIV>
<A name="anchor10"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.3"></A>
<H3>3.1.3.&nbsp; Requester Presents an Invalid Access Token</H3>
<P>If the requester presents an access token with its request, the host asks the 
AM to give it the requester access token's status (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Ask for Requester's Presented Access Token 
Status</SPAN><SPAN>)</SPAN></A>). If the AM reports that the token is invalid, 
the Host SHOULD return an HTTP 401 (Unauthorized) status code indicating it is 
an "invalid_token" (see Section 2.4.1 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth-bearer">[OAuth‑bearer]<SPAN> 
(</SPAN><SPAN class="info">Jones, M., “The OAuth 2.0 Protocol: Bearer Tokens,” 
June&nbsp;2011.</SPAN><SPAN>)</SPAN></A>), along with providing the AM's URI. 
This error indicates to the requester that the access token provided is expired, 
revoked, malformed, or invalid for other reasons.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 401 Unauthorized
WWW-Authenticate: UMA realm="example"
                     host_id="photoz.example.com",
                     am_uri="http://am.example.com"</PRE></DIV>
<A name="insufficient-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.4"></A>
<H3>3.1.4.&nbsp; Requester's Token Has Insufficient Permission</H3>
<P>If the requester presents an access token with its request, the host asks the 
AM to give it the requester access token's status (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Ask for Requester's Presented Access Token 
Status</SPAN><SPAN>)</SPAN></A>). If the AM supplies a token status description 
for a valid requester access token, the host examines the token status 
description. If the token status is not, in the host's judgment, associated with 
any currently valid permission that applies to the scope of access attempted by 
the requester, the Host SHOULD register the desired permission with the AM (see 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-register-scope">Section&nbsp;3.4<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Register a 
Permission</SPAN><SPAN>)</SPAN></A>) and then respond to the requester with the 
HTTP 403 (Forbidden) status code indicating that the token has 
"insufficient_scope" (see Section 2.4.1 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth-bearer">[OAuth‑bearer]<SPAN> 
(</SPAN><SPAN class="info">Jones, M., “The OAuth 2.0 Protocol: Bearer Tokens,” 
June&nbsp;2011.</SPAN><SPAN>)</SPAN></A>), along with providing the AM's URI and 
the permission ticket it just received from the AM.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 403 Forbidden
WWW-Authenticate: UMA realm="example"
                     host_id="photoz.example.com"
                     am_uri="http://am.example.com",
                     ticket="5454345rdsaa4543"</PRE></DIV>
<A name="sufficient-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.1.5"></A>
<H3>3.1.5.&nbsp; Requester's Token Has Sufficient Permission</H3>
<P>If the requester presents an access token with its request, the host asks the 
AM to give it the requester access token's status (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#h-am-token-validation">Section&nbsp;3.3<SPAN> 
(</SPAN><SPAN class="info">Host-AM: Ask for Requester's Presented Access Token 
Status</SPAN><SPAN>)</SPAN></A>) If the AM supplies a token status description 
for a valid requester access token, the host examines the token status 
description. If the token status, in the host's judgment, is associated with at 
least one currently valid permission that applies to the scope of access 
attempted by the requester, the host gives access to the desired resource.</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: image/jpeg
...

/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja
3kAAQAEAAAAPAAA/+4ADkFkb2JlAGTAAAAAAf
/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAo
KCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwb</PRE></DIV>
<P>This response constitutes the conclusion of Phase 3 of UMA.</P><A name="r-am-obtain-token"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.2"></A>
<H3>3.2.&nbsp; Requester-AM: Requester Obtains Access Token</H3>
<P>When a requester does not possess a valid access token to access resources of 
a particular user at a particular host, it requests one from the AM's requester 
token endpoint.</P>
<P>The requester learns about this endpoint by retrieving the AM's hostmeta 
document (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">Section&nbsp;2.1.1<SPAN> 
(</SPAN><SPAN class="info">AM Endpoints</SPAN><SPAN>)</SPAN></A>) based on the 
"am_uri" information that was provided by the host in its previous response, as 
described in Section 2 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta]. For example, if the "am_uri" 
is "am.example.com", the requester creates the URI 
"https://am.example.com/.well-known/host-meta" and performs a GET request on it.
</P>
<P>Each such token is unique per requester; requesting party on whose behalf the 
requester software is operating; authorizing user; AM; and host. It is not 
unique per protected resource or resource set; the token represents the set of 
permissions for that requesting party to access potentially a large set of 
different resource sets with a variety of scopes.</P>
<P>The requester SHOULD use the OAuth 2.0 client credentials authorization grant 
type (see Section 4.4 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
2010.</SPAN><SPAN>)</SPAN></A>).</P>
<P>In UMA, unlike in plain OAuth, obtaining an access token does not 
automatically convey permission for access to any protected resource. The token 
must first be associated with at least one suitable permission for scoped access 
in order for the requester to succeed in accessing the resource.</P>
<P>If the requester does not yet have a client identifier and the AM demands 
requesters to have unique client identifiers, the requester MAY use the dynamic 
OAuth registration protocol (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#Dyn-Reg">[Dyn‑Reg]<SPAN> 
(</SPAN><SPAN class="info">Scholz, C., “OAuth Dynamic Client Registration 
Protocol,” 2010.</SPAN><SPAN>)</SPAN></A>) proposed by the UMA participants, if 
the AM supports it.</P><A name="h-am-token-validation"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.3"></A>
<H3>3.3.&nbsp; Host-AM: Ask for Requester's Presented Access Token Status</H3>
<P>On receiving a requester access token in an access attempt, the host asks the 
AM for the token's status. If it has a cached token status description available 
that has not expired yet, it MAY use it instead.</P>
<P>The host makes the request to the AM with a POST to the AM's token status 
endpoint. The body of the HTTP request message contains a JSON <A class="info" 
href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#RFC4627">[RFC4627]<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
document providing the requester access token and the IP address of the 
requester's request. The host MAY, at its discretion, instead supply the 
originating IP address indicated in the requester's X-Forwarded-For: header 
value. The IP address or originating IP address is advisory only; the AM MAY 
ignore it for purposes of its own token validation process.</P>
<P>The host gains access to the token status endpoint by presenting its own host 
access token in the request. The host access token also allows the host and AM 
to uniquely identify the user they have in common, and therefore allows the AM 
to look up the correct authorizing user's policies and settings.</P>
<P></P>
<P>Example of a request to the token validation endpoint that provides the host 
access token in the header:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>POST /token_status HTTP/1.1
Host: am.example.com
Authorization: Bearer vF9dft4qmT
Content-Type: application/json

{
   "token":"sbjsbhs(/SSJHBSUSSJHVhjsgvhsgvshgsv"
   "resource_set_id":"112210f47de98100"
   "host_id":"photoz.example.com"
   "ipaddr":"192.168.1.1"
}</PRE></DIV>
<A name="token-valid"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.3.1"></A>
<H3>3.3.1.&nbsp; AM Returns a Token Status Description</H3>
<P>If the the AM finds the requester's access token to be valid, it returns the 
token's status in an HTTP response using the 200 OK status code, containing a 
JSON <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#RFC4627">[RFC4627]<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
document supplying the token status description. The token status description 
contains all of the permissions that are currently valid for this requester 
access token (and thus for the requesting party on whose behalf it is acting). 
The AM MAY set a cache period for the returned token status description that 
allows the host to reuse it over some period of time when it later sees the same 
requester access token.</P>
<P>The token status description is a JSON object with the name "token_status" 
containing an array of zero or more permission objects, each with the following 
parameters:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>resource_set_id</DT>
    <DD>REQUIRED. A string that uniquely identifies the resource set, access to 
    which has been granted to this requester on behalf of this requesting party. 
    The identifier MUST correspond to a resource set that was previously 
    registered as protected.</DD>
    <DT>scopes</DT>
    <DD>REQUIRED. An array referencing one or more URIs of scopes to which 
    access was granted for this resource set. Each scope MUST correspond to a 
    scope that was registered by this host for the referenced resource set.</DD>
    <DT>exp</DT>
    <DD>REQUIRED. An integer representing the expiration time on or after which 
    the permission MUST NOT be accepted for authorized access. The processing of 
    the exp parameter requires that the current date/time MUST be before the 
    expiration date/time listed in the exp claim. Host implementers MAY provide 
    for some small leeway, usually no more than a few minutes, to account for 
    clock skew.</DD></DL></BLOCKQUOTE>
<P>Example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
        "token_status":
           [
              {
                      "resource_set_id": "112210f47de98100",
                      "scopes":
                      ["http://photoz.example.com/dev/actions/view",
                        "http://photoz.example.com/dev/actions/all"],
                      "exp": 1300819380
              }
           ]
}</PRE></DIV>
<P></P><A name="token-invalid"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.3.2"></A>
<H3>3.3.2.&nbsp; AM Returns a Token Invalid Response</H3>
<P>If the the AM finds the requester's access token to be invalid, it returns an 
UMA error message.</P>
<P>The AM includes one of the following error codes in the error response: (see 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>) and 
responds with the HTTP 400 status code: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_requester_token</DT>
    <DD>AM determined that the requester access token was not valid.</DD>
    <DT>expired_requester_token</DT>
    <DD>AM determined that the requester access token has expired.</DD>
</DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
{
   "error":"invalid_requester_token"
}</PRE></DIV>
<A name="h-am-register-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.4"></A>
<H3>3.4.&nbsp; Host-AM: Register a Permission</H3>
<P>If, in the host's judgment, the permissions returned by the AM from a token 
status request are insufficient to allow this requester's access attempt, the 
host registers a permission with the AM that it believes would be sufficient for 
the type of access sought. As a result of the host registering a permission to 
the AM, the AM returns a permission ticket for the host to give to the requester 
in its response (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#insufficient-scope">Section&nbsp;3.1.4<SPAN> 
(</SPAN><SPAN class="info">Requester's Token Has Insufficient 
Permission</SPAN><SPAN>)</SPAN></A>).</P>
<P>The permissions ticket is a short-lived opaque structure whose contents is 
determined by the AM. Later when the requester asks the AM to add permissions to 
the requester's token (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#r-am-authz-scope">Section&nbsp;3.5<SPAN> 
(</SPAN><SPAN class="info">Requester-AM: Request Authorization to Add 
Permission</SPAN><SPAN>)</SPAN></A> it will submit this ticket to the AM. It is 
therefore the task of the AM to perform binding of this ticket to the requester 
and its token.</P>
<P>The host registers the permission using the POST method at the AM's 
permission registration endpoint, providing its host access token to get 
authorized access to this endpoint. The body of the HTTP request message 
contains a JSON <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#RFC4627">[RFC4627]<SPAN> 
(</SPAN><SPAN class="info">Crockford, D., “The application/json Media Type for 
JavaScript Object Notation (JSON),” July&nbsp;2006.</SPAN><SPAN>)</SPAN></A> 
document providing the requester's access token and the requested permission.
</P>
<P>The requested scope is an object with the name "requested_permission" and the 
following parameters:</P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>resource_set_id</DT>
    <DD>REQUIRED. A string that uniquely identifies a resource set, access to 
    which this requester is seeking access. The identifier MUST correspond to a 
    resource set that was previously registered as protected.</DD>
    <DT>scopes</DT>
    <DD>REQUIRED. An array referencing one or more identifiers of scopes to 
    which access is needed for this resource set. Each scope identifier MUST 
    correspond to a scope that was registered by this host for the referenced 
    resource set.</DD></DL></BLOCKQUOTE>
<P>Example of an HTTP request that registers a permission at the AM's permission 
registration endpoint:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>POST /host/scope_reg_uri/photoz.example.com HTTP/1.1
Content-Type: application/json
Host: am.example.com

{
        "requested_permission":
            {
            "resource_set_id":  "112210f47de98100",
            "scopes": ["http://photoz.example.com/dev/actions/view",
                        "http://photoz.example.com/dev/actions/all"]
        }
}</PRE></DIV>
<P>On receiving the scope registration request from the Host, the AM issues a 
response message that has one of the possible following outputs:</P>
<UL class="text">
  <LI>A permission ticket and its expiration time (typically very short).</LI>
  <LI>Error message indicating a malformed scope registration request.</LI></UL>
<P></P><A name="h-am-register-scope-success-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.4.1"></A>
<H3>3.4.1.&nbsp; AM Returns a Permission Registration Success Response</H3>
<P>The AM responds with an HTTP 201 (Created) status code and includes the 
Location header in its response as well as the "ticket" parameter in the 
JSON-formatted body:</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/json
Location: https://am.example.com/permreg/host/photoz.example.com/5454345rdsaa4543

   {
      "ticket":"5454345rdsaa4543"
   }</PRE></DIV>
<A name="h-am-register-scope-invalid-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.4.2"></A>
<H3>3.4.2.&nbsp; AM Returns a Permission Registration Error Response</H3>
<P>The AM responds with an HTTP 400 (Bad Request) status code and includes one 
of the following error codes with the error response (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>): </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_resource_set_id</DT>
    <DD>The provided resource set identifier was not found at the AM.</DD>
    <DT>invalid_scope</DT>
    <DD>At least one of the scopes included in the request was not registered 
    previously by this host.</DD>
    <DT>invalid_requester_token</DT>
    <DD>The requester access token was not recognized by the AM.</DD>
    <DT>expired_requester_token</DT>
    <DD>The requester access token has expired.</DD></DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
...

{
   "error":"invalid_resource_set_id"
}</PRE></DIV>
<A name="r-am-authz-scope"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.5"></A>
<H3>3.5.&nbsp; Requester-AM: Request Authorization to Add Permission</H3>
<P>In this interaction, the requester asks the AM to grant authorization to 
associate a new permission to its access token for use at a particular host. It 
does this at the AM's permission endpoint by supplying the permission ticket it 
got from the host, along with its requester access token. The AM uses this 
information to look up the previously registered permission, confirm that the 
correct requester is asking for it, map the requested permission to operative 
user policies, and demand in turn that the requester convey any claims needed to 
support its request.</P>
<P>The requester learns about this endpoint by retrieving the AM's hostmeta 
document (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">Section&nbsp;2.1.1<SPAN> 
(</SPAN><SPAN class="info">AM Endpoints</SPAN><SPAN>)</SPAN></A>) based on the 
"am_uri" information that was provided by the host in its previous response, as 
described in Section 2 of <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#hostmeta">hostmeta<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “Web Host Metadata,” 
May&nbsp;2011.</SPAN><SPAN>)</SPAN></A> [hostmeta]. For example, if the "am_uri" 
is "am.example.com", the requester creates the URI 
"https://am.example.com/.well-known/host-meta" and performs a GET request on it.
</P>
<P>The requester performs a GET on the permission endpoint, using the standard 
HTTP "Accept" header to express the acceptable media type(s) of any 
claims-requested response.</P>
<P>The AM responds in one of three ways: </P>
<UL class="text">
  <LI>If the AM requires no claims (or no further claims) from the requester in 
  order to grant authorization for the asked-for permission based on user 
  policy, it gives a success response, indicating that the requested scope has 
  been associated with the requester's token.</LI>
  <LI>If the requester is definitively not authorized for this permission 
  according to user policy, the AM responds with a failure response and the 
  authorization request phase ends.</LI>
  <LI>If user policy demands more information from the requester, the AM 
  responds with a claims-requested response. The list SHOULD use the claim 
  format media type that was indicated by the requester as acceptable.</LI></UL>
<P>The claims-requested list MAY contain internal logic that gives a choice or 
other variability around the sets of claims that will satisfy the request. This 
potentially allows the requester to select a subset of claims to supply in order 
to obtain the needed permission.</P>
<P>If claims are requested and the requester wishes to provide them, it POSTs 
another permission request, providing one or more claims or references to one or 
more locations where the AM can go to retrieve claims.</P>
<P>The AM responds with a successful or unsuccessful access token response, or 
with another claims-requested response. This loop can be run through as many 
times as necessary for the AM to request further claims and the requester to 
supply them, re-asking for authorization to get the needed permission at every 
juncture.</P>
<P>If the content-type of the request is not recognized by the AM, the AM MUST 
reject the document.</P>
<P></P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE></PRE></DIV>
<P>This specification does not define the formats of claims-requested lists and 
appropriate responses. It may ultimately put minimum conformance requirements on 
requesters and AMs to handle particular claim formats defined in other 
specifications, as well as specifying requirements that claim formats seeking 
consideration for use in UMA must meet. Two candidate solutions, corresponding 
to claim formats the AM can declare in its metadata (<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">Section&nbsp;2.1.1<SPAN> 
(</SPAN><SPAN class="info">AM Endpoints</SPAN><SPAN>)</SPAN></A>), are:</P>
<UL class="text">
  <LI><A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OpenID-Connect-Fmwk">[OpenID‑Connect‑Fmwk]<SPAN> 
  (</SPAN><SPAN class="info">Sakimura, N., “OpenID Connect Framework 1.0,” 
  June&nbsp;2011.</SPAN><SPAN>)</SPAN></A> (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#trusted-claims">Section&nbsp;3.5.1<SPAN> 
  (</SPAN><SPAN class="info">Trusted Claims with OpenID 
  Connect</SPAN><SPAN>)</SPAN></A> below for further context).</LI>
  <LI><A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#Claims2.0">[Claims2.0]<SPAN> 
  (</SPAN><SPAN class="info">Maler, E., “Claims 2.0,” 
  2010.</SPAN><SPAN>)</SPAN></A> and <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#SAAC">[SAAC]<SPAN> 
  (</SPAN><SPAN class="info">Maler, E., “Simple Access Authorization Claims,” 
  April&nbsp;2010.</SPAN><SPAN>)</SPAN></A>.</LI></UL><A 
name="trusted-claims"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.5.1"></A>
<H3>3.5.1.&nbsp; Trusted Claims with OpenID Connect</H3>
<P></P>
<P>It is hoped that UMA can profile the emerging OpenID Connect protocol as a 
mechanism to support access control to enable specific use cases in which the 
decision to grant access is made based on trusted (often third-party-asserted) 
claims about the requesting party, such as name, age, email address, role, and 
location.</P>
<P>OpenID Connect provides authentication, authorization, and attribute 
transmission capability. The integration approach would treat the claims-seeking 
UMA AM as an OpenID relying party and OpenID Connect claims client, leveraging 
OpenID Connect mechanisms to transmit claims from distributed sources.</P>
<P>In this scenario, the relying party interface is responsible for 
authenticating the subject (the UMA requesting party) and initializing the 
OpenID Connect protocol. The claims client interface is responsible for 
requesting claims based on OpenID Connect protocol, in order to satisfy the UMA 
authorizing user's policy. The client interacts with the OpenID Connect 
authorization server to obtain a specific access token to access to the 
subject's (UMA requesting party’s) UserInfo endpoint (trusted claims provider).
</P><A name="r-am-add-permissions-success-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.5.2"></A>
<H3>3.5.2.&nbsp; AM Returns an Add Permission Success Response</H3>
<P>The AM responds with an HTTP 201 (Created) status code and includes the 
updated token:</P>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 201 Created
Content-Type: application/json

   {
      "token":"sbjsbhs(/SSJHBSUSSJHVhjsgvhsgvshgsv"
   }</PRE></DIV>
<A name="r-am-add-permissions-invalid-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.3.5.3"></A>
<H3>3.5.3.&nbsp; AM Returns an Add Permission Error Response</H3>
<P>The AM responds with an HTTP 400 (Bad Request) status code and includes one 
of the following error codes with the error response (see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#uma-error-response">Section&nbsp;4.2<SPAN> 
(</SPAN><SPAN class="info">UMA Error Responses</SPAN><SPAN>)</SPAN></A>): </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_requester_ticket</DT>
    <DD>The provided ticket was not found at the AM.</DD>
    <DT>expired_requester_ticket</DT>
    <DD>At least one of the scopes included in the request was not registered 
    previously by this host.</DD>
    <DT>invalid_requester_token</DT>
    <DD>The requester access token was not recognized by the AM.</DD>
    <DT>expired_requester_token</DT>
    <DD>The requester access token has expired.</DD></DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
...

{
   "error":"expired_requester_ticket"
}</PRE></DIV>
<A name="anchor11"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.4"></A>
<H3>4.&nbsp; Error Messages</H3>
<P>Ultimately the host is responsible for either granting the access the 
requester attempted, or returning an error response to the requester with a 
reason for the failure. <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
2010.</SPAN><SPAN>)</SPAN></A> defines several error responses for a resource 
server to return. UMA makes use of these error responses, but requires the host 
to "outsource" the determination of some error conditions to the AM. UMA defines 
its own additional error responses that the AM may give to the host and 
requester as they interact with it, and that the host may give to the requester.
</P><A name="oauth-error-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.4.1"></A>
<H3>4.1.&nbsp; OAuth Error Responses</H3>
<P>When a client (host or requester) attempts to access one of the AM endpoints 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">Section&nbsp;2.1.1<SPAN> 
(</SPAN><SPAN class="info">AM Endpoints</SPAN><SPAN>)</SPAN></A> or a client 
(requester) attempts to access a protected resource at the host, it has to make 
an authenticated request by including an OAuth access token in the HTTP request 
as described in <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#OAuth2">[OAuth2]<SPAN> 
(</SPAN><SPAN class="info">Hammer-Lahav, E., “The OAuth 2.0 Protocol,” 
2010.</SPAN><SPAN>)</SPAN></A> Section 7.</P>
<P>If the client's request failed authentication, the AM or the host responds 
with an OAuth error message as described throughout <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#protecting-a-resource">Section&nbsp;2<SPAN> 
(</SPAN><SPAN class="info">Protecting a Resource</SPAN><SPAN>)</SPAN></A> and <A 
class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#getting-authz-accessing-resource">Section&nbsp;3<SPAN> 
(</SPAN><SPAN class="info">Getting Authorization and Accessing a 
Resource</SPAN><SPAN>)</SPAN></A>.</P><A name="uma-error-response"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.4.2"></A>
<H3>4.2.&nbsp; UMA Error Responses</H3>
<P>When a client (host or requester) attempts to access one of the AM endpoints 
<A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#am-endpoints">Section&nbsp;2.1.1<SPAN> 
(</SPAN><SPAN class="info">AM Endpoints</SPAN><SPAN>)</SPAN></A> or a client 
(requester) attempts to access a protected resource at the host, if the client 
request is successfully authenticated by OAuth means, but is invalid for another 
reason, the AM or host responds with an UMA error response by adding the 
following parameters to the entity body of the HTTP response using the 
"application/json" media type: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>error</DT>
    <DD>REQUIRED. A single error code. Value for this parameter is defined in 
    the specific AM endpoint description.</DD>
    <DT>error_description</DT>
    <DD>OPTIONAL. A human-readable text providing additional information, used 
    to assist in the understanding and resolution of the error occurred.</DD>
    <DT>error_uri</DT>
    <DD>OPTIONAL. A URI identifying a human-readable web page with information 
    about the error, used to provide the end-user with additional information 
    about the error.</DD></DL></BLOCKQUOTE>
<P>Common error codes: </P>
<BLOCKQUOTE class="text">
  <DL>
    <DT>invalid_request</DT>
    <DD>The request is missing a required parameter or is otherwise malformed. 
    The AM MUST respond with the HTTP 400 (Bad Request) status code.</DD>
</DL></BLOCKQUOTE>
<P>For example:</P>
<DIV style="width: 0px; margin-right: auto; margin-left: 3em; display: table;"><PRE>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
...

{
   "error":"invalid_request",
   "error_description":"There is already a resource with this identifier.",
   "error_uri":"http://am.example.com/errors/resource_exists"
}</PRE></DIV>
<A name="anchor12"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.5"></A>
<H3>5.&nbsp; Security Considerations</H3>
<P>This specification relies mainly on OAuth security mechanisms for protecting 
the host registration endpoint at the AM so that only a properly authorized host 
can access it on behalf of the intended user. For example, the host needs to use 
a valid host access token issued through a user authorization process at the 
endpoint, and the interaction SHOULD take place over TLS. It is expected that 
the host will protect its client secret (if it was issued one) and its host 
access token, particularly if used in "bearer token" fashion.</P>
<P>In addition, this specification dictates a binding between the host access 
token and the host-specific registration area on the AM to prevent a host from 
interacting with a registration area not its own.</P>
<P>For information about the technical, operational, and legal elements of trust 
establishment between UMA entities and parties, which affects security 
considerations, see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#UMA-trustmodel">[UMA‑trustmodel]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Trust Model,” 
February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>.</P>
<P></P><A name="anchor13"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.6"></A>
<H3>6.&nbsp; Privacy Considerations</H3>
<P>The AM comes to be in possession of resource set information (such as names 
and icons) that may reveal information about the user, which the AM's trust 
relationship with the host is assumed to accommodate. However, the requester is 
a less-trusted party (in fact, entirely untrustworthy until it acquires a 
requester access token in UMA protocol step 2). This specification recommends 
obscuring resource set identifiers in order to avoid leaking personally 
identifiable information to requesters through the "scope" mechanism.</P>
<P>For information about the technical, operational, and legal elements of trust 
establishment between UMA entities and parties, which affects privacy 
considerations, see <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#UMA-trustmodel">[UMA‑trustmodel]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Trust Model,” 
February&nbsp;2011.</SPAN><SPAN>)</SPAN></A>.</P><A name="anchor14"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.7"></A>
<H3>7.&nbsp; Conformance</H3>
<P>This section outlines conformance requirements for various entities 
implementing UMA endpoints.</P>
<P>This specification has dependencies on other specifications, as follows:</P>
<UL class="text">
  <LI>OAuth 2.0: AMs, hosts, and requesters MUST support OAuth 2.0 features 
  named in this specification for conformance. For example, AMs MUST support the 
  authorization code grant type for being introduced to hosts by authorizing 
  users.</LI>
  <LI>hostmeta: AMs, hosts, and requesters MUST support the hostmeta features 
  named in this specification for conformance.</LI></UL>
<P></P><A name="IANA"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.8"></A>
<H3>8.&nbsp; IANA Considerations</H3>
<P>TBD</P><A name="Acknowledgments"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.9"></A>
<H3>9.&nbsp; Acknowledgments</H3>
<P>The contributors to this specification include the Kantara UMA Work Group 
participants, a list of whom can be found at <A class="info" href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#UMAnitarians">[UMAnitarians]<SPAN> 
(</SPAN><SPAN class="info">Maler, E., “UMA Participant Roster,” 
2011.</SPAN><SPAN>)</SPAN></A>.</P><A name="anchor15"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.10"></A>
<H3>10.&nbsp; Issues</H3>
<P>Catalog of currently known issues.</P>
<UL class="text">
  <LI>ISSUE#14: Need to unify the request for authorization with the providing 
  of claims, so that this can be a single request-response pattern that can loop 
  as required.</LI>
  <LI>ISSUE#15: If the content-type (of the claims response document) is not 
  recognized by the AM, what happens then? Should be an error from the AM. We 
  need to create an error for this.</LI>
  <LI>ISSUE#16: Need to profile for specific claims-requested lists and claim 
  responses.</LI>
  <LI>ISSUE#17: Need to say what claims formats are supported.</LI>
  <LI>ISSUE#18: Provide commentary on any requirements layered on the 
  forthcoming OAuth security considerations section; discuss UMA-layer 
  implications for more meaningful authentication of requesters/requesting 
  parties; discuss implications of user-mediated AM/host trust model; discuss 
  short-lived token technique for lightweight requester correlation...</LI>
  <LI>ISSUE#19: More privacy considerations.</LI>
  <LI>ISSUE#24: From Lukasz email 6/6/2011: Rev8 Section 4.1: Empty response 
  body? In SAM we return 'resource_id' and 'policy_uri' so that the host can 
  redirect the user to the policy definition page (sharing setting screen) on 
  AM.</LI>
  <LI>ISSUE#25: From Lukasz email 6/6/2011: Section 4.1 - what happens when a 
  resource (being registered) already exists?</LI>
  <LI>ISSUE#27: Can Update Resource Set Description API mistakenly 
  overwrite/destroy an existing resource description?</LI>
  <LI>ISSUE #32: RESOLVED in Rev 13: Need to add back detail on how the host 
  tells the requester which AM to go to so that it can discover the token 
  endpoint and authorization endpoint. Lukasz and Maciej will flesh this out 
  with their own message examples. I think we still need to explain explicitly 
  how the requester has to construct the hostmeta URI.</LI>
  <LI>ISSUE #33: Should it be possible to have an "implicit resource set" 
  somehow that (in syntactic-sugar fashion) allows permissions to be passed 
  around much as scopes already are passed around in plain OAuth?</LI>
  <LI>ISSUE #35: Consider allowing the host to provide a filter in the token 
  validation request to indicate the particular resource sets/scopes it would 
  find acceptable, so that the AM can provide only permissions that potentially 
  match any of them. This approaches a PDP/PEP model.</LI>
  <LI>ISSUE #36: Okay to use the made-up URI 
  "http://kantarainitiative.org/ns/uma/1.0/..." for labeling the AM endpoints 
  and other identifying URIs? Should these actually resolve to anything?</LI>
  <LI>ISSUE #37: Okay to cache token status as now explained? Do we need to add 
  examples if so?</LI>
  <LI>ISSUE #38: Does the returned permission ticket need an expiration field?
  </LI>
  <LI>ISSUE #39: Examine all MAYs/SHOULDs throughout the spec to see what 
  conformance instructions/levels may be necessary. E.g., in Section 3.1.3, why 
  is the host's 401 Unauthorized response to a requester with an invalid token a 
  SHOULD instead of a MUST? When would it ever do something different? 
  Similarly, Section 3.1.4, why are the host's actions in the case of 
  insufficient permission a SHOULD instead of a MUST? Is it a case of the host 
  deciding to just not respond at all? In Section 3.2, why do we say the 
  requester SHOULD use the client credentials authorization grant type instead 
  of MUST?</LI>
  <LI>ISSUE #40: MUST the host give access if the requester has suitable 
  permission?</LI>
  <LI>ISSUE #41: MUST the host register a permission? If it doesn't want to, or 
  doesn't succeed in doing so, MUST it respond to the requester, and if so, 
  should the ticket (and even the am_uri) field be optional?</LI></UL><A name="rfc.references"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.11"></A>
<H3>11.&nbsp; References</H3><A name="rfc.references1"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<H3>11.1.&nbsp;Normative References</H3>
<TABLE border="0" width="99%">
  <TBODY>
  <TR>
    <TD class="author-text" vAlign="top"><A name="Dyn-Reg">[Dyn-Reg]</A></TD>
    <TD class="author-text">Scholz, C., “<A href="http://tools.ietf.org/html/draft-hardjono-oauth-dynreg-00.html">OAuth 
      Dynamic Client Registration Protocol</A>,” 2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
    name="OAuth-SAML">[OAuth-SAML]</A></TD>
    <TD class="author-text">Campbell, B., “<A href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-03">SAML 
      2.0 Bearer Assertion Grant Type Profile for OAuth 2.0</A>,” 
      February&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="OAuth-bearer">[OAuth-bearer]</A></TD>
    <TD class="author-text">Jones, M., “<A href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-06">The 
      OAuth 2.0 Protocol: Bearer Tokens</A>,” June&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="OAuth2">[OAuth2]</A></TD>
    <TD class="author-text">Hammer-Lahav, E., “<A href="http://tools.ietf.org/html/draft-ietf-oauth-v2-16">The 
      OAuth 2.0 Protocol</A>,” 2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="RFC2119">[RFC2119]</A></TD>
    <TD class="author-text"><A href="mailto:sob@harvard.edu">Bradner, S.</A>, 
      “<A href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to 
      Indicate Requirement Levels</A>,” BCP&nbsp;14, RFC&nbsp;2119, 
      March&nbsp;1997 (<A 
      href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</A>, <A href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</A>, 
      <A 
  href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</A>).</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="RFC4627">[RFC4627]</A></TD>
    <TD class="author-text">Crockford, D., “<A href="http://tools.ietf.org/html/rfc4627">The 
      application/json Media Type for JavaScript Object Notation (JSON)</A>,” 
      RFC&nbsp;4627, July&nbsp;2006 (<A href="http://www.rfc-editor.org/rfc/rfc4627.txt">TXT</A>).</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="hostmeta">[hostmeta]</A></TD>
    <TD class="author-text">Hammer-Lahav, E., “<A href="http://tools.ietf.org/html/draft-hammer-hostmeta-16">Web 
      Host Metadata</A>,” May&nbsp;2011.</TD></TR></TBODY></TABLE><A name="rfc.references2"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<H3>11.2.&nbsp;Informative References</H3>
<TABLE border="0" width="99%">
  <TBODY>
  <TR>
    <TD class="author-text" vAlign="top"><A 
    name="Claims2.0">[Claims2.0]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/Claims+2.0">Claims 
      2.0</A>,” 2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="OpenID-Connect-Fmwk">[OpenID-Connect-Fmwk]</A></TD>
    <TD class="author-text">Sakimura, N., “<A href="http://openid.net/specs/openid-connect-framework-1_0.html">OpenID 
      Connect Framework 1.0</A>,” June&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A name="SAAC">[SAAC]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/Simple+Access+Authorization+Claims">Simple 
      Access Authorization Claims</A>,” April&nbsp;2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMA-trustmodel">[UMA-trustmodel]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/UMA+Trust+Model">UMA 
      Trust Model</A>,” February&nbsp;2011.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMA-usecases">[UMA-usecases]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/UMA+Scenarios+and+Use+Cases">UMA 
      Scenarios and Use Cases</A>,” October&nbsp;2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMA-userstories">[UMA-userstories]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/User+Stories">UMA 
      User Stories</A>,” November&nbsp;2010.</TD></TR>
  <TR>
    <TD class="author-text" vAlign="top"><A 
      name="UMAnitarians">[UMAnitarians]</A></TD>
    <TD class="author-text">Maler, E., “<A href="http://kantarainitiative.org/confluence/display/uma/Participant+Roster">UMA 
      Participant Roster</A>,” 2011.</TD></TR></TBODY></TABLE><A 
name="History"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<A name="rfc.section.A"></A>
<H3>Appendix A.&nbsp; Document History</H3>
<P>NOTE: To be removed by RFC editor before publication as an RFC</P><A name="rfc.authors"></A><BR>
<HR>

<TABLE class="TOCbug" cellSpacing="2" summary="layout" cellPadding="0" align="right">
  <TBODY>
  <TR>
    <TD class="TOCbug"><A href="file:///C:/Users/Thomas%20Hardjono/AppData/Local/Temp/xml2rfc-xxe-6760162800686473332.html#toc">&nbsp;TOC&nbsp;</A></TD></TR></TBODY></TABLE>
<H3>Authors' Addresses</H3>
<TABLE border="0" cellSpacing="0" cellPadding="0" width="99%">
  <TBODY>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Thomas Hardjono (editor)</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">MIT</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:hardjono@mit.edu">hardjono@mit.edu</A></TD></TR>
  <TR cellpadding="3">
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Christian Scholz</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">COM.lounge GmbH</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:cs@comlounge.net">cs@comlounge.net</A></TD></TR>
  <TR>
    <TD class="author" align="right">URI:&nbsp;</TD>
    <TD class="author-text"><A 
      href="http://comlounge.net/">http://comlounge.net/</A></TD></TR>
  <TR cellpadding="3">
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Paul Bryan</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">pbryan.net</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:email@pbryan.net">email@pbryan.net</A></TD></TR>
  <TR>
    <TD class="author" align="right">URI:&nbsp;</TD>
    <TD class="author-text"><A 
    href="http://pbryan.net/">http://pbryan.net/</A></TD></TR>
  <TR cellpadding="3">
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Maciej Machulak</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Newcastle University</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:m.p.machulak@ncl.ac.uk">m.p.machulak@ncl.ac.uk</A></TD></TR>
  <TR>
    <TD class="author" align="right">URI:&nbsp;</TD>
    <TD class="author-text"><A 
    href="http://ncl.ac.uk/">http://ncl.ac.uk/</A></TD></TR>
  <TR cellpadding="3">
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Eve Maler</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">XMLgrrl.com</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:eve@xmlgrrl.com">eve@xmlgrrl.com</A></TD></TR>
  <TR>
    <TD class="author" align="right">URI:&nbsp;</TD>
    <TD class="author-text"><A 
      href="http://www.xmlgrrl.com/">http://www.xmlgrrl.com/</A></TD></TR>
  <TR cellpadding="3">
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Lukasz</TD></TR>
  <TR>
    <TD class="author-text">&nbsp;</TD>
    <TD class="author-text">Newcastle University</TD></TR>
  <TR>
    <TD class="author" align="right">Email:&nbsp;</TD>
    <TD class="author-text"><A 
      href="mailto:lukasz.moren@ncl.ac.uk">lukasz.moren@ncl.ac.uk</A></TD></TR>
  <TR>
    <TD class="author" align="right">URI:&nbsp;</TD>
    <TD class="author-text"><A 
    href="http://ncl.ac.uk/">http://ncl.ac.uk/</A></TD></TR>
</TBODY></TABLE></BODY></HTML>
